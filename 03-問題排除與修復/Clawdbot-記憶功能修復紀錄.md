# Clawdbot / OpenClaw è¨˜æ†¶åŠŸèƒ½ä¿®å¾©æŒ‡å—

---

## ğŸ“– é–±è®€å‰å¿…è®€ï¼šé€™æ˜¯ä»€éº¼ã€ä½•æ™‚ç”¨ã€æœ‰å¿…è¦å—ï¼Ÿ

### é€™æ˜¯ä»€éº¼ï¼Ÿ
æœ¬æ–‡ä»¶æ˜¯ **è¨˜æ†¶åŠŸèƒ½æ•…éšœæ’æŸ¥èˆ‡ä¿®å¾©æŒ‡å—**ï¼Œå°ˆé–€è™•ç†ï¼š
- `openclaw status` é¡¯ç¤º **Memory unavailable** çš„å•é¡Œ
- Bot å›å ±ã€Œè¨˜æ†¶æœå°‹ API é‡‘é‘°éŒ¯èª¤ã€çš„å•é¡Œ
- Embedding æ¨¡å‹è¨­å®šéŒ¯èª¤çš„ä¿®å¾©

### ä½•æ™‚éœ€è¦çœ‹é€™ä»½æ–‡ä»¶ï¼Ÿ
| æƒ…å¢ƒ | æ˜¯å¦éœ€è¦ | èªªæ˜ |
|------|---------|------|
| **åŸ·è¡Œ `openclaw status` é¡¯ç¤º Memory unavailable** | âœ… éœ€è¦ | è¨˜æ†¶åŠŸèƒ½æœ‰å•é¡Œï¼Œä¾æœ¬æ–‡æ’æŸ¥ |
| **Bot å›è¦†èªªç„¡æ³•å­˜å–é•·æœŸè¨˜æ†¶ã€API é‡‘é‘°éŒ¯èª¤** | âœ… éœ€è¦ | è¨˜æ†¶æœå°‹è¨­å®šæœ‰èª¤ï¼Œä¾æœ¬æ–‡ä¿®æ­£ |
| **ä¿®æ”¹æ¨¡å‹è¨­å®šå¾Œå‡ºç¾ "Unrecognized key: embedding"** | âœ… éœ€è¦ | è¨­å®šæ–¹å¼éŒ¯èª¤ï¼Œä¾æœ¬æ–‡æ­£ç¢ºè¨­å®š |
| **Bot é‹ä½œæ­£å¸¸ã€è¨˜æ†¶åŠŸèƒ½æ­£å¸¸** | âŒ ä¸éœ€è¦ | ç„¡é ˆé–±è®€ï¼Œè¨˜æ†¶åŠŸèƒ½æ­£å¸¸ |
| **ç¬¬ä¸€æ¬¡å®‰è£ OpenClaw** | âŒ ä¸éœ€è¦ | å…ˆå®Œæˆå®‰è£èˆ‡è¨­å®šï¼Œæœ‰å•é¡Œæ™‚å†å›ä¾†çœ‹ |

### èˆ‡å…¶ä»–æ–‡ä»¶çš„é—œä¿‚
- **01-OpenClaw-æœ¬æ©Ÿå®‰è£èˆ‡å®‰å…¨é‡è£æŒ‡å—.md**ï¼šå®‰è£èˆ‡åˆå§‹è¨­å®š
- **æœ¬æ–‡ä»¶**ï¼šç•¶è¨˜æ†¶åŠŸèƒ½å‡ºç¾æ•…éšœæ™‚çš„æ’æŸ¥èˆ‡ä¿®å¾©
- **Clawdbot-ç©©å®šæ€§å„ªåŒ–èˆ‡æ¨¡å‹é…ç½®æŒ‡å—.md**ï¼šæ¨¡å‹é¸æ“‡èˆ‡ fallback è¨­å®š

### å¿…è¦å—ï¼Ÿ
- **å¦‚æœæ‚¨çš„ Bot è¨˜æ†¶åŠŸèƒ½æ­£å¸¸é‹ä½œ** â†’ ä¸å¿…è¦ï¼Œç„¡é ˆé–±è®€
- **å¦‚æœå‡ºç¾ä¸Šè¿°è¨˜æ†¶ç›¸é—œéŒ¯èª¤** â†’ å¿…è¦ï¼Œé€™æ˜¯å”¯ä¸€çš„ä¿®å¾©æŒ‡å—

---

è‹¥ `clawdbot status`ï¼ˆæˆ– `openclaw status`ï¼‰é¡¯ç¤º **Memory â”‚ enabled (plugin memory-core) Â· unavailable**ï¼Œæˆ– Bot å›å ±è¨˜æ†¶æœå°‹ API é‡‘é‘°éŒ¯èª¤ï¼Œå¯ä¾æœ¬æŒ‡å—æ’æŸ¥ã€‚  
**èªªæ˜**ï¼šè‹¥æ‚¨ä½¿ç”¨ OpenClawï¼Œè«‹å°‡ä¸‹åˆ— `clawdbot` æ”¹ç‚º `openclaw`ï¼Œè·¯å¾‘ `~/.clawdbot` æ”¹ç‚º `~/.openclaw`ã€‚

---

## 1. å•é¡Œç¾è±¡

- ç‹€æ…‹é¡¯ç¤ºï¼š**Memory â”‚ enabled (plugin memory-core) Â· unavailable**
- Bot å›è¦†ï¼šè¨˜æ†¶æœå°‹é¡¯ç¤º API é‡‘é‘°éŒ¯èª¤ï¼Œç„¡æ³•å­˜å–é•·æœŸè¨˜æ†¶

---

## 2. éŒ¯èª¤çš„è¨­å®šæ–¹å¼ï¼ˆæœƒå ±éŒ¯ï¼‰

**ä¸è¦**ç”¨ä¸‹åˆ—æ–¹å¼è¨­å®š embeddingï¼Œæœƒå¤±æ•—ï¼š

```bash
clawdbot config set agents.defaults.model.embedding "google/text-embedding-004"
# Error: agents.defaults.model: Unrecognized key: "embedding"
```

**åŸå› **ï¼š`agents.defaults.model` åƒ…æ¥å—å°è©±ç”¨ LLMï¼ˆå¦‚ `primary`ã€`fallbacks`ï¼‰ï¼Œä¸åŒ…å« `embedding`ã€‚

---

## 3. æ­£ç¢ºçš„ Embedding è¨­å®š

Embedding æ˜¯çµ¦**è¨˜æ†¶æœå°‹ï¼ˆmemory searchï¼‰**ç”¨çš„ï¼Œéœ€å¯«åœ¨ `agents.defaults.memorySearch`ï¼š

```bash
# è¨­å®š providerï¼ˆä¾‹å¦‚ Geminiï¼‰
clawdbot config set agents.defaults.memorySearch.provider "gemini"

# è¨­å®š embedding æ¨¡å‹
clawdbot config set agents.defaults.memorySearch.model "google/text-embedding-004"
```

è‹¥ç‰ˆæœ¬ä¸æ”¯æ´ `google/text-embedding-004`ï¼Œå¯æ”¹ç”¨ï¼š

```bash
clawdbot config set agents.defaults.memorySearch.model "gemini-embedding-001"
```

è¨­å®šå¾Œéœ€ **é‡å•Ÿ gateway**ï¼š`clawdbot gateway restart`

---

## 4. è¨˜æ†¶ä» unavailableï¼šAPI é‡‘é‘°å•é¡Œ

è¨­å®šå®Œ provider/model å¾Œè‹¥ä»é¡¯ç¤º unavailable æˆ– API é‡‘é‘°éŒ¯èª¤ï¼Œå¤šåŠæ˜¯**è¨˜æ†¶æœå°‹ä½¿ç”¨çš„ Gemini Embedding API éœ€è¦ Google API é‡‘é‘°**ã€‚åƒ…æœ‰ OAuthï¼ˆå¦‚ google-antigravityï¼‰ä¸ä¸€å®šèƒ½æä¾› embeddingï¼Œéœ€æœ‰ä¸€çµ„ **API Key** å‹æ…‹çš„ Google é‡‘é‘°ã€‚

---

## 5. auth-profiles.json ä½ç½®èˆ‡ç”¨é€”

- **è·¯å¾‘**ï¼š`~/.clawdbot/agents/main/agent/auth-profiles.json`ï¼ˆOpenClaw å‰‡ç‚º `~/.openclaw/` å°æ‡‰çµæ§‹ï¼‰
- Bot ç”±æ­¤è®€å–å„ provider èªè­‰ã€‚è¨˜æ†¶æœå°‹éœ€è¦ä¸€çµ„ **googleã€type: api_key** çš„ profileï¼ˆä¾‹å¦‚ `google:default`ï¼‰ã€‚

---

## 6. è§£æ³•ï¼šåŠ å…¥ Google API é‡‘é‘°

ä½¿ç”¨ **Google AI Studio ç­‰æä¾›çš„å…è²» API é‡‘é‘°**å³å¯ï¼Œåƒ…ä¾› **embeddingï¼ˆè¨˜æ†¶æœå°‹ï¼‰** ä½¿ç”¨ï¼Œä¸å½±éŸ¿å°è©±æ¨¡å‹ï¼ˆGPT / Claude ç­‰ï¼‰ã€‚

åœ¨ `auth-profiles.json` çš„ `profiles` ä¸­æ–°å¢æˆ–ä¿®æ­£ï¼š

```json
"google:default": {
  "type": "api_key",
  "provider": "google",
  "key": "æ‚¨çš„_Google_API_é‡‘é‘°"
}
```

åœ¨ `lastGood` ä¸­ç¢ºä¿æœ‰ï¼š

```json
"google": "google:default"
```

å­˜æª”å¾ŒåŸ·è¡Œï¼š`clawdbot gateway restart`

---

## 7. ä¿®å¾©æˆåŠŸçš„è¡¨ç¾

é‡å•Ÿå¾Œ `clawdbot status` çš„ Memory è¡Œæœƒé¡¯ç¤ºé¡ä¼¼ï¼š

```
Memory â”‚ N files Â· M chunks Â· ... Â· vector ready Â· fts ready Â· cache on (...)
```

è¡¨ç¤ºå·²ç´¢å¼•è¨˜æ†¶æª”ã€å‘é‡èˆ‡å…¨æ–‡æœå°‹å°±ç·’ï¼Œé•·æœŸè¨˜æ†¶å¯æ­£å¸¸ä½¿ç”¨ã€‚

---

## 8. è‹¥å‡ºç¾ã€Œgemini batch failedã€404 éŒ¯èª¤

æ—¥èªŒå‡ºç¾ï¼š

```
[memory] embeddings: gemini batch failed; ... asyncBatchEmbedContent not available ...
Disable remote.batch.enabled or switch providers.
```

**åŸå› **ï¼šéƒ¨åˆ† API æˆ– embedding æ¨¡å‹ä¸æ”¯æ´ Gemini çš„éåŒæ­¥æ‰¹æ¬¡ä»‹é¢ã€‚

**è§£æ³•**ï¼šé—œé–‰è¨˜æ†¶æœå°‹çš„é ç«¯æ‰¹æ¬¡ï¼Œæ”¹ç‚ºä¸€èˆ¬ embeddingã€‚

åœ¨è¨­å®šæª”ï¼ˆå¦‚ `~/.clawdbot/clawdbot.json`ï¼‰çš„ `agents.defaults.memorySearch` ä¸­åŠ ä¸Šï¼š

```json
"remote": {
  "batch": {
    "enabled": false
  }
}
```

æˆ–åŸ·è¡Œï¼š

```bash
clawdbot config set agents.defaults.memorySearch.remote.batch.enabled false
```

è¨­å®šå¾ŒåŸ·è¡Œ `clawdbot gateway restart`ã€‚

---

## 9. æ—¥å¾Œæ›æ©Ÿæˆ–é‡è£å¯åƒè€ƒ

1. **Embedding**ï¼šä½¿ç”¨ `agents.defaults.memorySearch.provider` èˆ‡ `agents.defaults.memorySearch.model`ï¼Œå‹¿ç”¨ `agents.defaults.model.embedding`ã€‚
2. **é‡‘é‘°**ï¼šåœ¨ `auth-profiles.json` ä¿ç•™æˆ–é‚„åŸ `google:default`ï¼ˆapi_keyï¼‰ï¼Œæˆ–æ”¹è¨­ç’°å¢ƒè®Šæ•¸ `GEMINI_API_KEY`ã€‚
3. **é‡å•Ÿ**ï¼šä»»ä½• config æˆ– auth è®Šæ›´å¾ŒåŸ·è¡Œ `clawdbot gateway restart`ã€‚
